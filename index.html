<!DOCTYPE html>
<html>
  <head>
    <title>WebRTC Test - 1-1 & Nhóm</title>
    <link rel="icon" href="data:," />
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/7.0.5/signalr.min.js"></script>
  </head>
  <body>
    <h2>WebRTC Test - Gọi 1-1 & Nhóm</h2>

    <div id="info"></div>
    <div id="status" class="status"></div>

    <div class="container">
      <!-- Gọi 1-1 -->
      <div class="call-section">
        <h3>Gọi 1-1</h3>
        <div>
          <label>
            Remote ID:
            <input id="remoteId" value="user2" placeholder="Nhập ID người nhận" />
          </label>
        </div>

        <div>
          <button id="videoCallBtn" onclick="startCall('video')">
            📹 Gọi video
          </button>
          <button id="audioCallBtn" onclick="startCall('audio')">
            🎧 Gọi audio
          </button>
        </div>
      </div>

      <!-- Gọi nhóm -->
      <div class="call-section">
        <h3>Gọi nhóm</h3>
        <div>
          <label>
            Group ID:
            <input id="groupId" placeholder="Nhập ID nhóm (để trống để tạo mới)" />
          </label>
        </div>

        <div>
          <button id="createGroupBtn" onclick="createGroupCall()">
            🆕 Tạo nhóm
          </button>
          <button id="joinGroupBtn" onclick="joinGroupCall()">
            ➕ Tham gia nhóm
          </button>
          <button id="leaveGroupBtn" onclick="leaveGroupCall()" disabled>
            👋 Rời nhóm
          </button>
        </div>
      </div>

      <!-- Nút chung -->
      <div>
        <button id="hangupBtn" onclick="hangup()" disabled>📞 Kết thúc cuộc gọi</button>
      </div>
    </div>

    <!-- Video containers -->
    <div class="video-container">
      <div>
        <h4>Video của bạn</h4>
        <video id="localVideo" autoplay muted playsinline></video>
      </div>
      <div id="remoteVideoContainer">
        <h4>Video đối phương</h4>
        <video id="remoteVideo" autoplay playsinline></video>
      </div>
    </div>

    <!-- Group call container -->
    <div id="groupCallContainer" class="group-call-container" style="display: none;">
      <h3>Cuộc gọi nhóm: <span id="currentGroupId"></span></h3>
      <div class="group-members-header">
        <h4>Thành viên trong nhóm (<span id="memberCount">0</span>)</h4>
      </div>
      <div id="remoteVideos" class="remote-videos-grid"></div>
    </div>

    <!-- Call Popup -->
    <div id="callPopup" class="call-popup-overlay" style="display: none;">
      <div class="call-popup">
        <h3>📞 Cuộc gọi đến</h3>
        <div class="call-info">
          <div class="caller-name" id="callerName">Đang tải...</div>
          <div class="call-type" id="callType">audio</div>
          <div class="call-time" id="callTime">Vừa xong</div>
        </div>
        <div class="call-buttons">
          <button class="accept-btn" id="acceptCallBtn">
            <span class="ringing-animation">📞</span>
            Nghe máy
          </button>
          <button class="reject-btn" id="rejectCallBtn">
            <span>❌</span>
            Từ chối
          </button>
        </div>
      </div>
    </div>

<script src="config.js"></script>
<script src="ui.js"></script>
<!-- ĐẶT webrtc.js và signalr-handlers.js TRƯỚC main.js -->
<script src="webrtc.js"></script>
<script src="signalr-handlers.js"></script>
<script src="main.js"></script>
  </body>
</html>